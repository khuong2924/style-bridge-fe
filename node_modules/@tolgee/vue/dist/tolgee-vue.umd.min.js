!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("@tolgee/web")):"function"==typeof define&&define.amd?define(["exports","vue","@tolgee/web"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["@tolgee/vue"]={},e.vue,e["@tolgee/web"])}(this,(function(e,t,n){"use strict";const o=t.defineComponent({name:"TolgeeProvider",props:{tolgee:{type:Object,required:!1},fallback:{type:[Object,String]},ssr:{type:[Object,Boolean],required:!1}},setup(e){const n=t.inject("tolgeeContext");e.tolgee&&(n.value.tolgee=e.tolgee);const o=t.computed((()=>n.value.tolgee));if(!o.value)throw new Error("Tolgee instance not provided");if(n.value.isInitialRender&&Boolean(e.ssr)){const t="object"==typeof e.ssr?e.ssr:{};if(o.value.setEmitterActive(!1),o.value.addStaticData(t.staticData),o.value.changeLanguage(t.language),o.value.setEmitterActive(!0),!o.value.isLoaded()){const e=o.value.getRequiredDescriptors(t.language).map((({namespace:e,language:t})=>e?`${e}:${t}`:t)).filter((e=>{var n;return!(null===(n=t.staticData)||void 0===n?void 0:n[e])}));console.warn(`Tolgee: Missing records in "staticData" for proper SSR functionality: ${e.map((e=>`"${e}"`)).join(", ")}`)}}t.onMounted((()=>{n.value.isInitialRender=!1}));const a=t.ref(!o.value.isLoaded());return t.onBeforeMount((()=>{o.value.run().finally((()=>{a.value=!1}))})),t.onUnmounted((()=>{o.value.stop()})),{isLoading:a}},render(){var e,t,n,o;return this.isLoading?(null===(o=(n=this.$slots).fallback)||void 0===o?void 0:o.call(n))||this.fallback||null:null===(t=(e=this.$slots).default)||void 0===t?void 0:t.call(e)}}),a=e=>{const o=n.getFallback(e),a=t.inject("tolgeeContext"),l=t.computed((()=>a.value.tolgee));if(!l.value)throw new Error("Tolgee instance not provided");const s=t.ref(u()),r=l.value.on("update",(()=>{s.value=u(),i.value=!l.value.isLoaded(o)}));l.value.addActiveNs(o),t.onUnmounted((()=>{null==r||r.unsubscribe(),l.value.removeActiveNs(o)}));const i=t.ref(!l.value.isLoaded(o));function u(){return e=>{var t;const n=null!==(t=e.ns)&&void 0!==t?t:null==o?void 0:o[0];return l.value.t(Object.assign(Object.assign({},e),{ns:n}))}}return{t:s,isLoading:i}},l=t.defineComponent({name:"T",props:{keyName:{type:String,required:!0},params:Object,defaultValue:String,noWrap:{type:Boolean,default:!1},ns:{type:String},language:{type:String}},setup(){const{t:e}=a();return{t:e}},render(){const e={};Object.keys(this.$slots).forEach((t=>{e[t]=this.$slots[t]()}));const t=Object.assign({},this.$props.params,e),n={key:this.$props.keyName,params:t,defaultValue:this.$props.defaultValue,noWrap:this.$props.noWrap,ns:this.$props.ns,language:this.$props.language};return this.t(n)}}),s={install(e,o){const a=null==o?void 0:o.tolgee;if(!a)throw new Error("Tolgee instance not passed in options");const l=Boolean(null==o?void 0:o.enableSSR),s=t.ref({tolgee:a,isInitialRender:l});if(e.provide("tolgeeContext",s),l){const e=()=>Object.assign(Object.assign({},s.value.tolgee),{t:(...e)=>{const t=n.getTranslateProps(...e);return a.t(Object.assign({},t))}}),o=()=>Object.assign(Object.assign({},s.value.tolgee),{t:(...e)=>{const t=n.getTranslateProps(...e);return a.t(Object.assign(Object.assign({},t),{noWrap:!0}))}});s.value.tolgee=o(),t.watch((()=>s.value.isInitialRender),(t=>{t||(s.value.tolgee=e())}))}s.value.tolgee.on("cache",(()=>{s.value.tolgee=Object.freeze(Object.assign({},s.value.tolgee))})),e.config.globalProperties.$t=(...e)=>s.value.tolgee.t(...e),e.config.globalProperties.$tolgee=s.value.tolgee}};e.GlobalContextPlugin=()=>e=>e,e.T=l,e.TolgeeProvider=o,e.VueTolgee=s,e.useTolgee=e=>{const n=t.getCurrentInstance(),o=t.inject("tolgeeContext"),a=t.computed((()=>o.value.tolgee)),l=null==e?void 0:e.map((e=>a.value.on(e,(()=>{o.value.tolgee=Object.freeze(Object.assign({},a.value)),n.proxy.$forceUpdate()}))));return t.onUnmounted((()=>{null==l||l.forEach((e=>e.unsubscribe()))})),a},e.useTranslate=e=>{const{t:o,isLoading:l}=a(e);return{t:t.computed((()=>(...e)=>{const t=n.getTranslateProps(...e);return o.value(t)})),isLoading:l}},Object.keys(n).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})}))}));
//# sourceMappingURL=tolgee-vue.umd.min.js.map
