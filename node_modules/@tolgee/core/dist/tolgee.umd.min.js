!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self)["@tolgee/core"]={})}(this,(function(e){"use strict";function n(e){return Boolean(e&&"function"==typeof e.then)}function a(e,a){return n(e)?Promise.resolve(e).then(a):a(e)}function t(e,a,t){function i(n){const t=a(n);throw e.emit(t),console.error(t),t}try{const e=t();return n(e)?e.catch(i):e}catch(e){i(e)}}function i(e){const n=(Array.isArray(e)?e:[e]).map((e=>`'${e}'`)),a=n.slice(-2).join(" or ");return`Tolgee: You need to specify ${[...n.slice(0,-2),a].join(", ")} option`}function o(e){return"string"==typeof e?[e]:Array.isArray(e)?e:void 0}function r(e){return o(e)||[]}function s(e,n){return"object"!=typeof(a=n)||Array.isArray(a)||null===a?r(n):r(null==n?void 0:n[e]);var a}function g(e){return Array.from(new Set(e))}function l(e){return e?e.replace(/\/+$/,""):e}const c=(e,n)=>fetch(e,n);const u=(e=c)=>(n,a)=>{let t=(i=null==a?void 0:a.headers,Object.fromEntries(new Headers(i).entries()));var i;return t["x-api-key"]&&(t=Object.assign({"x-tolgee-sdk-type":"JS","x-tolgee-sdk-version":"prerelease"},t)),e(n,Object.assign(Object.assign({},a),{headers:t}))},d=(e,n)=>{let a=[];return{listen(e){const n=n=>{e(n)};return a.push(n),{unsubscribe(){a=a.filter((e=>n!==e))}}},emit(t){n()&&a.forEach((n=>n({type:e,value:t})))}}};function f(e){let n=[],a=[];function t(){if(0===a.length)return;const e=a;a=[],n.forEach((n=>{n(e)}))}return Object.freeze({listen(e){const a=n=>{e(n)};return n.push(a),{unsubscribe(){n=n.filter((e=>a!==e))}}},emit(n,i){e()&&e()&&(a.push(n),i?setTimeout(t,0):t())}})}class p extends Error{constructor(e,n,a=!1){const{language:t,namespace:i}=e;super(`Tolgee: Failed to fetch record for "${t}"${i&&` and "${i}"`}`),this.cause=n,this.isDev=a,this.name="RecordFetchError",this.language=t,this.namespace=i}}class v extends Error{constructor(e,n){super(e),this.cause=n,this.name="LanguageDetectorError"}}class h extends Error{constructor(e,n){super(e),this.cause=n,this.name="LanguageStorageError"}}const m=e=>{const n=new Map;return Object.entries(e).forEach((([e,a])=>{null!=a&&("object"!=typeof a?n.set(e,a):m(a).forEach(((a,t)=>{n.set(e+"."+t,a)})))})),n},b=e=>Object.fromEntries(m(e).entries()),y=e=>{const[n,...a]=e.split(":");return{language:n,namespace:a.join(":")||""}},L=({language:e,namespace:n})=>n?`${e}:${n}`:e;function O(e,a,t,i,o,s,l){const c=new Map,u=new Map;let d={},f=0;function v(n,a,t){const i=L(n);u.set(i,{data:b(a),version:t}),e.onCacheChange.emit(y(i))}async function h(i,o){let r;if(o)try{r=await t(i)}catch(n){const a=new p(i,n,!0);e.onError.emit(a),console.warn(a)}return r||(r=await async function(t){function i(n){const a=new p(t,n);throw e.onError.emit(a),console.error(a),a}const o=a(t);if(n(o)){const e=await o.catch(i);if(void 0!==e)return e}const r=d[L(t)];if("function"!=typeof r)return r;try{return await r()}catch(e){i(e)}}(i)),r}const m=Object.freeze({addStaticData(e){if(Array.isArray(e))for(const n of e){const e=L(n),a=u.get(e);a&&0!==a.version||v(n,b(n.data),0)}else e&&(d=Object.assign(Object.assign({},d),e),Object.entries(e).forEach((([e,n])=>{if("function"!=typeof n){const a=y(e),t=u.get(e);t&&0!==t.version||v(a,b(n),0)}})))},invalidate(){c.clear(),f+=1},addRecord(e,n){v(e,b(n),f)},exists(e,n=!1){const a=u.get(L(e));return a&&n?a.version===f:Boolean(a)},getRecord(e){const n=i(e),a=L(n),t=u.get(a);if(t)return Object.assign(Object.assign({},n),{cacheKey:a,data:t.data})},getAllRecords:()=>Array.from(u.entries()).map((([e])=>m.getRecord(y(e)))),getTranslation(e,n){var a;return null===(a=u.get(L(e)))||void 0===a?void 0:a.data[n]},getTranslationNs(e,n,a){var t;for(const i of e)for(const e of n){const n=null===(t=u.get(L({language:e,namespace:i})))||void 0===t?void 0:t.data[a];if(null!=n)return[i]}return g(e)},getTranslationFallback(e,n,a){var t;for(const i of e)for(const e of n){const n=null===(t=u.get(L({language:e,namespace:i})))||void 0===t?void 0:t.data[a];if(null!=n)return n}},changeTranslation(n,a,t){var i;const o=null===(i=u.get(L(n)))||void 0===i?void 0:i.data;(null==o?void 0:o[a])&&(o[a]=t,e.onCacheChange.emit(Object.assign(Object.assign({},n),{key:a})))},isFetching(e){if(o())return!0;if(void 0===e)return c.size>0;const n=r(e);return Boolean(Array.from(c.keys()).find((e=>n.includes(y(e).namespace))))},isLoading(e,n){const a=r(n);if(o())return!0;const t=Array.from(c.keys());return Boolean(t.find((n=>{const t=y(n);return(!a.length||a.includes(t.namespace))&&!m.exists({namespace:t.namespace,language:e})})))},async loadRecords(e,n){const a=e.map((e=>{const a=i(e),t=L(a);if(null==n?void 0:n.useCache){if(m.exists(a,!0))return Object.assign(Object.assign({},a),{new:!1,cacheKey:t,data:m.getRecord(a).data})}const o=c.get(t);if(o)return Object.assign(Object.assign({},a),{new:!1,promise:o,cacheKey:t});const r=h(a,!(null==n?void 0:n.noDev))||Promise.resolve(void 0);return c.set(t,r),Object.assign(Object.assign({},a),{new:!0,promise:r,cacheKey:t})}));s.notify(),l.notify();const t=a.map((e=>e.promise)).filter(Boolean),o=await Promise.all(t);return a.forEach((e=>{var n;e.promise&&(e.data=b(null!==(n=o[0])&&void 0!==n?n:{}),o.shift());const a=c.get(e.cacheKey)!==e.promise;e.new&&!a&&(c.delete(e.cacheKey),e.data?m.addRecord(e,e.data):m.getRecord(e)||m.addRecord(e,{}))})),s.notify(),l.notify(),a.map((e=>{var n;return{language:e.language,namespace:e.namespace,data:null!==(n=e.data)&&void 0!==n?n:{},cacheKey:e.cacheKey}}))}});return m}function j(e,n){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(a[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)n.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(a[t[i]]=e[t[i]])}return a}const w="invalid",R={observerOptions:{tagAttributes:{textarea:["placeholder"],input:["value","placeholder"],img:["alt"],"*":["aria-label","title"]},restrictedElements:["script","style"],highlightKeys:["Alt"],highlightColor:"rgb(255, 0, 0)",highlightWidth:5,inputPrefix:"%-%tolgee:",inputSuffix:"%-%",passToParent:["option","optgroup"],fullKeyEncode:!1},observerType:"invisible",onFormatError:w,apiUrl:"https://app.tolgee.io",autoLoadRequiredData:!0,fetch:u(),onTranslationMissing:({key:e})=>e},k=(...e)=>{let n={};return e.forEach((e=>{n=Object.assign(Object.assign(Object.assign({},n),e),{observerOptions:Object.assign(Object.assign({},n.observerOptions),null==e?void 0:e.observerOptions)})})),n};function E(e,n){const a=k(R,null==n?void 0:n.initialOptions,e);return a.apiUrl=l(a.apiUrl),(null==e?void 0:e.fetch)&&(a.fetch=u(e.fetch)),{initialOptions:a,activeNamespaces:(null==n?void 0:n.activeNamespaces)||new Map,language:null==n?void 0:n.language,pendingLanguage:null==n?void 0:n.language,isInitialLoading:!1,isRunning:!1}}function D(e,n,i,o,r,s,g,l){const c={ui:void 0},u={formatters:[],finalFormatter:void 0,observer:void 0,devBackend:void 0,backends:[],ui:void 0,languageDetector:void 0,languageStorage:void 0},d=async({keysAndDefaults:e,target:n})=>{var a;const t=e.map((({key:e,ns:n,defaultValue:a})=>({key:e,defaultValue:a,fallbackNamespaces:o(n),namespace:r({key:e,ns:n})[0],translation:s({key:e,ns:n})})));null===(a=u.ui)||void 0===a||a.handleElementClick(t,n)},f=(e,n)=>{var a;return(null===(a=u.observer)||void 0===a?void 0:a.findPositions(e,n))||[]};function p(e){const n=s({key:e.key,ns:e.ns});return A.formatTranslation(Object.assign(Object.assign({},e),{translation:n,formatEnabled:!0}))}function m(){return{fetch:n().fetch}}function b(e){u.observer=null==e?void 0:e()}function y(){return Boolean(u.observer)}function L(e){e&&u.formatters.push(e)}function O(e){u.finalFormatter=e}function R(e){c.ui=e}function k(){return Boolean(c.ui)}function E(e){u.languageStorage=e}function D(e){u.languageDetector=e}function N(e){e&&u.backends.push(e)}function C(e){u.devBackend=e}const A=Object.freeze({addPlugin:function(e,n){n(e,Object.freeze({setFinalFormatter:O,addFormatter:L,setObserver:b,hasObserver:y,setUi:R,hasUi:k,setDevBackend:C,addBackend:N,setLanguageDetector:D,setLanguageStorage:E}))},findPositions:f,run(){var e,a;const{apiKey:t,apiUrl:i,projectId:o,observerOptions:r,tagNewKeys:s,filterTag:v}=n();u.ui=null===(e=c.ui)||void 0===e?void 0:e.call(c,{apiKey:t,apiUrl:i,projectId:o,highlight:A.highlight,changeTranslation:g,findPositions:f,onPermanentChange:e=>l.onPermanentChange.emit(e),tagNewKeys:s,filterTag:v}),null===(a=u.observer)||void 0===a||a.run({mouseHighlight:!0,options:r,translate:p,onClick:d})},stop(){var e;u.ui=void 0,null===(e=u.observer)||void 0===e||e.stop()},getLanguageStorage:()=>u.languageStorage,getInitialLanguage(){const e=i();return a(t(l.onError,(e=>new h("Tolgee: Failed to load language",e)),(()=>{var e;return null===(e=u.languageStorage)||void 0===e?void 0:e.getLanguage(m())})),(n=>e&&!e.includes(n)||!n?function(){if(!u.languageDetector)return;const e=i();return t(l.onError,(e=>new v("Tolgee: Failed to detect language",e)),(()=>{var n;return null===(n=u.languageDetector)||void 0===n?void 0:n.getLanguage(Object.assign({availableLanguages:e},m()))}))}():n))},setStoredLanguage:e=>t(l.onError,(e=>new h("Tolgee: Failed to store language",e)),(()=>{var n;return null===(n=u.languageStorage)||void 0===n?void 0:n.setLanguage(e,m())})),getDevBackend:()=>u.devBackend,getBackendRecord:async({language:e,namespace:n})=>{for(const a of u.backends){const t=await a.getRecord(Object.assign({language:e,namespace:n},m()));if(void 0!==t)return t}},getBackendDevRecord:async({language:e,namespace:a})=>{var t;const{apiKey:i,apiUrl:o,projectId:r,filterTag:s}=n();if(i&&o&&A.hasDevBackend())return null===(t=u.devBackend)||void 0===t?void 0:t.getRecord(Object.assign({apiKey:i,apiUrl:o,projectId:r,language:e,namespace:a,filterTag:s},m()))},getLanguageDetector:()=>u.languageDetector,retranslate(){var e;null===(e=u.observer)||void 0===e||e.retranslate()},highlight:(e,n)=>{var a,t;return(null===(t=null===(a=u.observer)||void 0===a?void 0:a.highlight)||void 0===t?void 0:t.call(a,e,n))||{unhighlight(){}}},unwrap(e){var n;return u.observer?null===(n=u.observer)||void 0===n?void 0:n.unwrap(e):{text:e,keys:[]}},wrap(e){var n;return u.observer?null===(n=u.observer)||void 0===n?void 0:n.wrap(e):e.translation},hasDevBackend:()=>Boolean(A.getDevBackend()),formatTranslation(a){var t,{formatEnabled:i}=a,o=j(a,["formatEnabled"]);const{key:r,translation:s,defaultValue:g,noWrap:l,params:c,ns:d,orEmpty:f}=o,p=null!=s?s:g;let v="";null==s&&(v=n().onTranslationMissing(o));let h=null!=p?p:f?"":v;const m=e(),b=i||!(null===(t=u.observer)||void 0===t?void 0:t.outputNotFormattable),y=e=>u.observer&&!l?u.observer.wrap({key:r,translation:e,defaultValue:g,params:c,ns:d}):e;h=y(h);try{if(p&&m&&b)for(const e of u.formatters)h=e.format({translation:h,language:m,params:c});u.finalFormatter&&p&&m&&b&&(h=u.finalFormatter.format({translation:h,language:m,params:c}))}catch(e){console.error(e);const a=("string"==typeof(L=e)?L:"string"==typeof(null==L?void 0:L.message)?L.message:void 0)||w,t=n().onFormatError,i=typeof t;h="string"===i?t:"function"===i?t(a,o):w,h=y(h)}var L;return h}});return A}const N=(e,n,a)=>{let t=e;return Object.freeze({init(e){t=e},notify(){const e=n();t!==e&&a(e),t=e}})};const C=(e,...n)=>{let a,t={};return"object"==typeof e?t=e:(t.key=e,"string"==typeof n[0]?(t.defaultValue=n[0],a=n[1]):"object"==typeof n[0]&&(a=n[0])),a&&(t=Object.assign(Object.assign({},function(e){var{ns:n,noWrap:a,orEmpty:t,params:i,language:o}=e,r=j(e,["ns","noWrap","orEmpty","params","language"]);const s={ns:n,noWrap:a,orEmpty:t,language:o};return Object.assign(Object.assign({},s),{params:Object.assign({},r)})}(a)),t)),t};function A({options:e}){const t=function(){let e=!0;function n(){return e}const a=Object.freeze({onPendingLanguageChange:d("pendingLanguage",n),onLanguageChange:d("language",n),onLoadingChange:d("loading",n),onFetchingChange:d("fetching",n),onInitialLoaded:d("initialLoad",n),onRunningChange:d("running",n),onCacheChange:d("cache",n),onPermanentChange:d("permanentChange",n),onError:d("error",n),onUpdate:f(n),setEmitterActive(n){e=n},on:(e,n)=>{switch(e){case"pendingLanguage":return a.onPendingLanguageChange.listen(n);case"language":return a.onLanguageChange.listen(n);case"loading":return a.onLoadingChange.listen(n);case"fetching":return a.onFetchingChange.listen(n);case"initialLoad":return a.onInitialLoaded.listen(n);case"running":return a.onRunningChange.listen(n);case"cache":return a.onCacheChange.listen(n);case"update":return a.onUpdate.listen(n);case"permanentChange":return a.onPermanentChange.listen(n);case"error":return a.onError.listen(n)}}});return a.onInitialLoaded.listen((e=>a.onUpdate.emit(e,!1))),a.onLanguageChange.listen((e=>a.onUpdate.emit(e,!1))),a.onCacheChange.listen((e=>a.onUpdate.emit(e,!0))),a}(),o=N(!1,(()=>v.isFetching()),t.onFetchingChange.emit),c=N(!1,(()=>T.isLoading()),t.onLoadingChange.emit),u=function(e,n,a){let t,i=E();const o=Object.freeze({init(e){i=E(e,i)},isRunning:()=>i.isRunning,setRunning(e){i.isRunning!==e&&(i.isRunning=e,a.emit(e))},isInitialLoading:()=>i.isInitialLoading,setInitialLoading(e){i.isInitialLoading=e},getLanguage:()=>i.language||i.initialOptions.language,setLanguage(n){i.language!==n&&(i.language=n,e.emit(n))},getPendingLanguage:()=>i.pendingLanguage||o.getLanguage(),setPendingLanguage(e){i.pendingLanguage!==e&&(i.pendingLanguage=e,n.emit(e))},getInitialOptions:()=>Object.assign(Object.assign({},i.initialOptions),t),addActiveNs(e){r(e).forEach((e=>{const n=i.activeNamespaces.get(e);void 0!==n?i.activeNamespaces.set(e,n+1):i.activeNamespaces.set(e,1)}))},removeActiveNs(e){r(e).forEach((e=>{const n=i.activeNamespaces.get(e);void 0!==n&&n>1?i.activeNamespaces.set(e,n-1):i.activeNamespaces.delete(e)}))},getRequiredNamespaces:()=>g([o.getDefaultNs(),...i.initialOptions.ns||[],...r(i.initialOptions.fallbackNs),...i.activeNamespaces.keys()]),getFallbackLangs(e){const n=e||o.getLanguage();return n?g([n,...s(n,i.initialOptions.fallbackLanguage)]):[]},getFallbackNs:()=>r(i.initialOptions.fallbackNs),getNs(){var e,n;return(null===(e=i.initialOptions.ns)||void 0===e?void 0:e.length)?i.initialOptions.ns:[null!==(n=i.initialOptions.defaultNs)&&void 0!==n?n:""]},getDefaultNs(e){var n,a,t;return void 0===e?null!==(t=null!==(n=i.initialOptions.defaultNs)&&void 0!==n?n:null===(a=i.initialOptions.ns)||void 0===a?void 0:a[0])&&void 0!==t?t:"":e},getAvailableLanguages(){if(i.initialOptions.availableLanguages)return i.initialOptions.availableLanguages;if(i.initialOptions.staticData){const e=Object.keys(i.initialOptions.staticData).map((e=>y(e).language));return Array.from(new Set(e))}},getAvailableNs:()=>i.initialOptions.availableNs,withDefaultNs:e=>({namespace:void 0===e.namespace?o.getDefaultNs():e.namespace,language:e.language}),overrideCredentials(e){t=e?Object.assign(Object.assign({},e),{apiUrl:l(e.apiUrl)}):void 0}});return o}(t.onLanguageChange,t.onPendingLanguageChange,t.onRunningChange),p=D(u.getLanguage,u.getInitialOptions,u.getAvailableLanguages,b,k,A,j,t),v=O(t,p.getBackendRecord,p.getBackendDevRecord,u.withDefaultNs,u.isInitialLoading,o,c);let h;function m(e){return u.getDefaultNs(e)}function b(e){return g([...r(m(e)),...u.getFallbackNs()])}function L(e){return g([...r(null!=e?e:m()),...u.getRequiredNamespaces()])}function j(e,n,a){const t=u.withDefaultNs(e),i=v.getTranslation(t,n);return v.changeTranslation(t,n,a),{revert(){v.changeTranslation(t,n,i)}}}function w(e){u.init(e),v.addStaticData(u.getInitialOptions().staticData)}function R(e,n){const a=u.getFallbackLangs(e),t=L(n),i=[];return a.forEach((e=>{t.forEach((n=>{i.push({language:e,namespace:n})}))})),i}function k({key:e,ns:n}){const a=u.getFallbackLangs(),t=b(null!=n?n:void 0);return v.getTranslationNs(t,a,e)}function A({key:e,ns:n,language:a}){const t=b(null!=n?n:void 0),i=u.getFallbackLangs(a);return v.getTranslationFallback(t,i,e)}function F(){const e=a(P(),(()=>{const e=R(n,a).filter((e=>!v.exists(e,!0)));var n,a;if(e.length&&u.getInitialOptions().autoLoadRequiredData)return v.loadRecords(e,{useCache:!0})}));if(n(e))return u.setInitialLoading(!0),o.notify(),c.notify(),Promise.resolve(e).then((()=>{u.setInitialLoading(!1),o.notify(),c.notify(),t.onInitialLoaded.emit()}));t.onInitialLoaded.emit()}function P(){if(u.getLanguage())return;return a(p.getInitialLanguage(),(e=>{const n=e||u.getInitialOptions().defaultLanguage;n&&u.setLanguage(n)}))}e&&w(e),t.onUpdate.listen((()=>{u.isRunning()&&p.retranslate()}));const T=Object.freeze(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t),u),p),v),{init:w,getTranslation:A,changeTranslation:j,getTranslationNs:k,getDefaultAndFallbackNs:b,findPositions:p.findPositions,getRequiredDescriptors:R,async changeLanguage(e){u.getPendingLanguage()===e&&u.getLanguage()===e||(u.setPendingLanguage(e),u.isRunning()&&u.getInitialOptions().autoLoadRequiredData&&await v.loadRecords(R(e),{useCache:!0}),e===u.getPendingLanguage()&&(u.setLanguage(e),await p.setStoredLanguage(e)))},async addActiveNs(e,n){n||u.addActiveNs(e),u.isRunning()&&await v.loadRecords(R(void 0,e),{useCache:!0})},async loadRecord(e,n){var a;return null===(a=(await T.loadRecords([e],n))[0])||void 0===a?void 0:a.data},isLoading:e=>v.isLoading(u.getLanguage(),e),isLoaded(e){const n=u.getLanguage();if(!n)return!1;const a=u.getFallbackLangs(n),t=L(e),i=[];return a.forEach((e=>{t.forEach((n=>{v.exists({language:e,namespace:n})||i.push({language:e,namespace:n})}))})),0===i.length},t:(...e)=>{const n=C(...e),a=A(n);return p.formatTranslation(Object.assign(Object.assign({},n),{translation:a}))},isDev:()=>Boolean(u.getInitialOptions().apiKey&&u.getInitialOptions().apiUrl),async loadRequired(e){(null==e?void 0:e.language)||await P();const n=R(null==e?void 0:e.language);return T.loadRecords(n,e)},async loadMatrix(e){const n=function(e){let n=[],a=[];if(Array.isArray(e.languages))n=e.languages;else if("all"===e.languages){const e=T.getAvailableLanguages();if(!e)throw new Error(i("availableLanguages"));n=e}if(Array.isArray(e.namespaces))a=e.namespaces;else if("all"===e.namespaces){const e=T.getAvailableNs();if(!e)throw new Error(i("availableNs"));a=e}const t=[];return n.forEach((e=>{a.forEach((n=>{t.push({language:e,namespace:n})}))})),t}(e);return T.loadRecords(n,e)},run:()=>(function(){if((p.getLanguageDetector()||p.getLanguageStorage())&&!u.getAvailableLanguages())throw new Error(i("availableLanguages"));if(!u.getLanguage()&&!u.getInitialOptions().defaultLanguage)throw new Error(i(["defaultLanguage","language"]))}(),u.isRunning()||(u.setRunning(!0),p.run(),h=F()),Promise.resolve(h)),stop(){u.isRunning()&&(p.stop(),u.setRunning(!1))}}));return T}const F=0,P=1,T=2;class I extends Error{constructor(e,n,a){let t,i="";e===F?t="Empty parameter":e===P?(t="Unexpected character",i="Did you forget to use FormatIcu to render ICU message syntax?"):t="Unexpected end",super(`Tolgee parser: ${t} at ${n} in "${a}"`+(i?"\n"+i:"")),this.code=e,this.index=n}}function x(e){return/\s/.test(e)}const S=0,B=1,U=2,K=3,$=4,z=new Set([U,B,S]),q="'",M=new Set(["{","}",q]),V=e=>/[0-9a-zA-Z_]/.test(e);function W(e,n){const[a,t]=function(e){let n=S,a="",t="",i="";const o=[],r=[];let s=0;function g(n){throw new I(n,s,e)}const l=()=>{o.push(a),a=""},c=()=>{""===t&&g(F),r.push(t),t=""};for(s=0;s<e.length;s++)switch(i=e[s],n){case S:i===q?(a+=i,n=B):"{"===i?(l(),n=K):(a+=i,n=S);break;case B:M.has(i)?(a=a.slice(0,-1)+i,n=U):(a+=i,n=S);break;case U:i===q?n=S:(a+=i,n=U);break;case K:"}"===i?(c(),n=S):x(i)?""!==t&&(c(),n=$):(V(i)||g(P),t+=i,n=K);break;case $:"}"==i?n=S:x(i)?n=$:g(P)}return z.has(n)||g(T),l(),[o,r]}(e),i=[a[0]];for(let o=1;o<a.length;o++){const r=null==n?void 0:n[t[o-1]];if(void 0===r)throw new Error(`Missing parameter "${t[o-1]}" in "${e}"`);i.push(String(r)),i.push(a[o])}return i.join("")}e.FormatSimple=()=>(e,n)=>(n.setFinalFormatter({format:({translation:e,params:n})=>W(e,n)}),e),e.LanguageDetectorError=v,e.LanguageStorageError=h,e.RecordFetchError=p,e.TolgeeCore=()=>{const e={plugins:[],options:{}},n=Object.freeze({use:a=>(e.plugins.push(a),n),updateDefaults:a=>(e.options=k(e.options,a),n),init(n){const a=function(e){const n=A({options:e});function a(e){const a=n.isRunning();a&&n.stop(),e(),n.isDev()&&n.invalidate(),a&&n.run()}n.isDev()&&n.invalidate();const t=Object.freeze({on:n.on,setEmitterActive:n.setEmitterActive,getLanguage:n.getLanguage,getPendingLanguage:n.getPendingLanguage,changeLanguage:n.changeLanguage,changeTranslation:n.changeTranslation,addActiveNs:n.addActiveNs,removeActiveNs:n.removeActiveNs,loadRequired:n.loadRequired,loadMatrix:n.loadMatrix,loadRecords:n.loadRecords,loadRecord:n.loadRecord,addStaticData:n.addStaticData,getRecord:n.getRecord,getAllRecords:n.getAllRecords,isLoaded:n.isLoaded,getRequiredDescriptors:n.getRequiredDescriptors,isInitialLoading:n.isInitialLoading,isLoading:n.isLoading,isFetching:n.isFetching,isRunning:n.isRunning,run:n.run,stop:n.stop,t:n.t,highlight:n.highlight,findPositions:n.findPositions,getInitialOptions:n.getInitialOptions,isDev:n.isDev,wrap:n.wrap,unwrap:n.unwrap,overrideCredentials(e){a((()=>n.overrideCredentials(e)))},addPlugin(e){e&&a((()=>n.addPlugin(t,e)))},updateOptions(e){e&&a((()=>n.init(e)))}});return t}(k(e.options,n));return e.plugins.forEach(a.addPlugin),a}});return n},e.createFetchFunction=u,e.getFallback=o,e.getFallbackArray=r,e.getTranslateProps=C,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tolgee.umd.min.js.map
